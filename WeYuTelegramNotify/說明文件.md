## API 使用說明

### GET `/api/notify/telegram`

以查詢參數（Query String）方式發送 Telegram 訊息。

* * *

#### Request 範例

```http
GET http://localhost/WeYuTelegramNotify/api/notify/telegram?
    chatId=123456789
    &subject=設備異常通知%20-%20EQP-7F-021
    &body=設備%3A%20{{EQP}}%0A異常代碼%3A%20{{ALM}}
    &tokens[EQP]=EQP-7F-021
    &tokens[ALM]=ALM-1287
```

* * *

#### Query Parameters

* **chatId** _(必填)_：目標使用者或群組的 Telegram chatId。

* **subject** _(選填)_：通知標題。

* **body** _(必填)_：通知內容（支援 `%0A` 換行與 `{{Token}}` 置換）。

* **tokens** _(選填)_：`Tokens[key]=value` 形式提供替換用字典，若訊息中出現 `{{key}}` 會被對應的 `value` 取代。

* * *

#### Response 範例( 以上面Get的舉例 )

成功：

```json
{
  "message": "sent",
  "subject": "設備異常通知 - EQP-7F-021",
  "body": "設備：EQP-7F-021（沖壓機 #21）\n異常代碼：ALM-1287\n異常名稱：油壓過低\n等級：重大\n發生時間：2025/08/27 09:15:42\n建議處置：立即停機檢查油壓泵，聯絡設備工程。",
  "logId": "f8b3f8c1-7f64-4b53-9e92-9e4a2a1f5a31"
}
```

失敗：

```json
{
  "message": "failed",
  "stage": "Validation",
  "error": "Body is required.",
  "httpStatus": null,
  "logId": null
}
```

* * *