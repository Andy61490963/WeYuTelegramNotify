## API 使用說明

### GET `/api/notify/telegram`

以查詢參數（Query String）方式發送 Telegram 訊息。

* * *

#### Request 範例

```http
GET http://localhost/DcMateTelegramNotify/api/notify/telegram?
    id=4D675486-2CD5-4749-A55D-9E50931C935D
    &subject=設備異常通知%20-%20EQP-7F-021
    &body=設備%EF%BC%9A%7B%7BEQP_NO%7D%7D%EF%BC%88%7B%7BEQP_NAME%7D%7D%EF%BC%89%0A異常代碼%EF%BC%9A%7B%7BALARM_CODE%7D%7D%0A異常名稱%EF%BC%9A%7B%7BALARM_NAME%7D%7D%0A等級%EF%BC%9A%7B%7BSEVERITY%7D%7D%0A發生時間%EF%BC%9A%7B%7BOCCUR_TIME%7Cyyyy%2FMM%2Fdd%20HH%3Amm%3Ass%7D%7D%0A建議處置%EF%BC%9A%7B%7BACTION_SUGGEST%7D%7D
    &tokens.EQP_NO=EQP-7F-021
    &tokens.EQP_NAME=沖壓機%20%2321
    &tokens.ALARM_CODE=ALM-1287
    &tokens.ALARM_NAME=油壓過低
    &tokens.SEVERITY=重大
    &tokens.OCCUR_TIME=2025-08-27
    &tokens.ACTION_SUGGEST=立即停機檢查油壓泵，聯絡設備工程
```

* * *

#### Query Parameters

* **id** _(必填)_：目標使用者或群組的識別碼 (GUID)。

* **subject** _(必填)_：通知標題。

* **body** _(選填)_：通知內容（支援 `%0A` 換行）。

* **TemplateId** _(選填)_：模板Id，如果不想自己寫body模板，可以找資料庫的模板。

* **token** _(必填)_：模板替換字串(key需要對應body裡面的目標替換字元)。

* * *

#### Response 範例( 以上面Get的舉例 )

成功：

```json
{
  "message": "sent",
  "subject": "設備異常通知 - EQP-7F-021",
  "body": "設備：EQP-7F-021（沖壓機 #21）\n異常代碼：ALM-1287\n異常名稱：油壓過低\n等級：重大\n發生時間：2025/08/27 09:15:42\n建議處置：立即停機檢查油壓泵，聯絡設備工程。",
  "logId": "f8b3f8c1-7f64-4b53-9e92-9e4a2a1f5a31"
}
```

失敗： 

```json
{
  "message": "invalid id",
  "httpStatus": 400,
  "logId": null
}
```

* * *